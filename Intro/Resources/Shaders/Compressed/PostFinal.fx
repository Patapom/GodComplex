#include"Inc/Global.hlsl"
Texture2D _TexNoise:register(t10),_TexHDR:register(t11);cbuffer cbTextureLOD:register( b10){float _LOD;float _BackLight;};struct VS_IN{float4 Position:SV_POSITION;};VS_IN VS(VS_IN E){return E;}float4 r(float2 E){float3 V=float3(0.,-1.f,0.),y=float3(0,1,0),L=float3(0.,0.,0.),r=10.*1..xxx,t=.5*1..xxx,f=_Camera2World[3].xyz,x=mul(float4(_CameraData.x*(2.*E.x-1.),_CameraData.y*(1.-2.*E.y),1.,0.),_Camera2World).xyz;float l=dot(V-f,y)/dot(x,y);l=l<0.?1000.:l;float3 P=f+l*x;l=.5*pow(abs(l),.25);float3 a=float3(0.,1.,0.);float I=length(a-P);I=pow(saturate(.42*I),3.);return l*I;}float4 PS(VS_IN E):SV_TARGET0{float4 l=TEX(_TexHDR,LinearWrap,E.Position.xy*INV_SCREEN_SIZE);float2 V=2.*float2(ASPECT_RATIO*E.Position.x,E.Position.y)*INV_SCREEN_SIZE;float4 x=lerp(.1,1.,_BackLight)*r(E.Position.xy*INV_SCREEN_SIZE);return lerp(x,l,l.w);}